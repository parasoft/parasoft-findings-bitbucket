# Parasoft Findings Bitbucket
A CLI tool to read Parasoft static analysis XML reports and upload results to Bitbucket.

## Quick Start
To display Parasoft static analysis results on Bitbucket, you need to customize your Bitbucket pipeline to:
  1. Generate a Parasoft static analysis XML report.
  2. Use this tool to upload the report results to Bitbucket.

### Prerequisites
- Node.js 18+

- Java 17+

- Parasoft static analysis XML report is generated

### Bitbucket configuration
- Create Repository Variables **USER_EMAIL** and **API_TOKEN** used for BitBucket API access.

- Install the Parasoft Findings Bitbucket CLI globally:
    ```yaml
    npm i -g github:parasoft/parasoft-findings-bitbucket
    ```

### Adding the Parasoft Findings Bitbucket tool to Bitbucket Pipeline
```yaml
name: "Parasoft Findings Bitbucket"
script:
  # Use parasoft-findings-bitbucket to upload Parasoft static analysis XML report results to Bitbucket
  - parasoft-findings-bitbucket --report "</path/to/report.xml>" --parasoftToolOrJavaRootPath "<path/to/parasoftTool>" --debug
```

### Command line options:

| Parameters                              | Description                                                                                                                                                                                                         |
|-----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| --report (Required)                     | Path or minimatch pattern to locate Parasoft static analysis report files. If using a relative path, it is relative to the Bitbucket clone directory.                                                               |
| --parasoftToolOrJavaRootPath (Optional) | Root path to the Parasoft tool or Java installation required to locate the Java environment for report processing. If not specified, the tool will attempt to use the path from the JAVA_HOME environment variable. |
| --debug (Optional)                      | Enable to show debug log messages.                                                                                                                                                                                  |
| --version                               | Print version number and exit.                                                                                                                                                                                      |
| --help                                  | Print help information and exit.                                                                                                                                                                                    |

## Example configuration file for Bitbucket pipeline
Here is a basic Bitbucket pipeline example to help you get started with the parasoft-findings-bitbucket tool:

```yaml
pipelines:
  default:
      - step:
          runs-on:
            - self.hosted
            - windows
          name: "Upload Parasoft static analysis XML report results via Parasoft Findings Bitbucket"
          script:
            # Install Parasoft Findings Bitbucket tool
            - npm i -g github:parasoft/parasoft-findings-bitbucket

            # Generate Parasoft Static Analysis XML report
            - jtestcli.exe -config "builtin://Recommended Rules" -settings "localsettings.properties" -data "demo.data.json" -report "reports/static/report.xml"

            # Use parasoft-findings-bitbucket to upload Parasoft static analysis XML report results to Bitbucket
            - parasoft-findings-bitbucket --report "reports/static/report.xml" --parasoftToolOrJavaRootPath "C:/Java/jdk-17" --debug
```

## Known Limitations in Bitbucket
- For Flow and Duplicate vulnerabilities, the Bitbucket report can only display plain text (no formatting). As a result, only a brief summary is shown. For full details, please refer to the HTML report generated by the Parasoft tool (C/C++test, Jtest, or dotTEST).
- Each report can display a maximum of 1,000 vulnerabilities.
- The description for each vulnerability is limited to 2,000 characters.